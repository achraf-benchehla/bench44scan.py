#!/usr/bin/env python3


# sudo apt install python3-pip
# pip install python-nmap
# Use these commands in Kali to install required software:
#pip3 install X 
import time 
import nmap
import keyboard
import re
import os
import requests
import argparse
import sys
# def des variable 
ip_add_pattern = re.compile("^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$")
port_range_pattern = re.compile("([0-9]+)-([0-9]+)")
port_min = 0
port_max = 65535
#affichage d'interface 
def main():
    print(r"""
      ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤
      ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤
      ¤¤													 	                      ¤¤
      ¤¤     __________________________________________________________________________________________		     			      ¤¤
      ¤¤                   													              ¤¤
      ¤¤       ______  _____  _   _  _____  _   _            ___         _____  _____   ___   _   _  					      ¤¤
      ¤¤       | ___ \|  ___|| \ | |/  __ \| | | |          /   |       /  ___|/  __ \ / _ \ | \ | | 					      ¤¤
      ¤¤       | |_/ /| |__  |  \| || /  \/| |_| | ______  / /| | ______\ `--. | /  \// /_\ \|  \| | 					      ¤¤              
      ¤¤       | ___ \|  __| | . ` || |    |  _  ||______|/ /_| ||______|`--. \| |    |  _  || . ` | 					      ¤¤
      ¤¤       | |_/ /| |___ | |\  || \__/\| | | |        \___  |       /\__/ /| \__/\| | | || |\  | 					      ¤¤
      ¤¤       \____/ \____/ \_| \_/ \____/\_| |_/            |_/       \____/  \____/\_| |_/\_| \_/ 					      ¤¤
      ¤¤                                                                                      						      ¤¤
      ¤¤     __________________________________________________________________________________________                                       ¤¤      
      ¤¤  																      ¤¤
      ¤¤					                      									      ¤¤
      ¤¤		  ==> https://github.com/achraf-benchehla/bench44scan.py                        				      ¤¤               
      ¤¤		  ==> aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL2JlbmNoZWhsYS1hY2hyYWYv                                                    ¤¤
      ¤¤		  ==> Author: Achraf Benchehla Contact: benchehlaachraf@gmail.com  						      ba	
      ¤¤                                      					              						      se
      ¤¤																      64
      ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤
      ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤
""")

    print("\t\t                ****   Choose your options to get started   **** \n")
    print("\t<========================================================================================================================>")
    print("\t  \n  \t\t * >1< SCAN PORT OF TARGET \n  \t\t * >#< SCAN WITH NMAP  \n  \t\t\t + >21< unknown SCAN  \n  \t\t\t + >22< OS TARGET DETECT  \n  \t\t\t + >23< FAST SCAN \n  \t\t\t + >24< SCAN VERSION OF PROTOCOL  \n  \t\t * >3< SCAN WITH MASSCAN  \n  \t\t * >4< BRUTE_FORCE & Enumeraion  \n\n  \t\t (**) FOR EXAMPLE : 1 , 21 , 22 , 23 , 24 , 3 , 4")
    print("\n")
    print("\t<========================================================================================================================>")
    
    n = input("\n\n\t =====> : NUMBER OF OPTIONS  ")
    if n == '1':
         print("\n\n")
         print("  \t\t\t\t\t\t\t\t #####    START SCAN PROCESS    #####")
         print("\n\n")
         print("""
____________________________________________________________________________________________________________________________________________________     

███████╗ ██████╗ █████╗ ███╗   ██╗    ██████╗  ██████╗ ██████╗ ████████╗     ██████╗ ███████╗    ████████╗ █████╗ ██████╗  ██████╗ ███████╗████████╗
██╔════╝██╔════╝██╔══██╗████╗  ██║    ██╔══██╗██╔═══██╗██╔══██╗╚══██╔══╝    ██╔═══██╗██╔════╝    ╚══██╔══╝██╔══██╗██╔══██╗██╔════╝ ██╔════╝╚══██╔══╝
███████╗██║     ███████║██╔██╗ ██║    ██████╔╝██║   ██║██████╔╝   ██║       ██║   ██║█████╗         ██║   ███████║██████╔╝██║  ███╗█████╗     ██║   
╚════██║██║     ██╔══██║██║╚██╗██║    ██╔═══╝ ██║   ██║██╔══██╗   ██║       ██║   ██║██╔══╝         ██║   ██╔══██║██╔══██╗██║   ██║██╔══╝     ██║   
███████║╚██████╗██║  ██║██║ ╚████║    ██║     ╚██████╔╝██║  ██║   ██║       ╚██████╔╝██║            ██║   ██║  ██║██║  ██║╚██████╔╝███████╗   ██║   
╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝    ╚═╝      ╚═════╝ ╚═╝  ╚═╝   ╚═╝        ╚═════╝ ╚═╝            ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝ ╚══════╝   ╚═╝   
____________________________________________________________________________________________________________________________________________________     
         """)
         print("\n")
         scan_port()
         
    if n == '21':
         print("\n\n")
         print("  \t\t\t\t\t\t\t\t #####    START SCAN PROCESS    #####")
         print("\n\n")
         print("""
_________________________________________________________________________________________________________

██╗   ██╗███╗   ██╗██╗  ██╗███╗   ██╗ ██████╗ ██╗    ██╗███╗   ██╗    ███████╗ ██████╗ █████╗ ███╗   ██╗
██║   ██║████╗  ██║██║ ██╔╝████╗  ██║██╔═══██╗██║    ██║████╗  ██║    ██╔════╝██╔════╝██╔══██╗████╗  ██║
██║   ██║██╔██╗ ██║█████╔╝ ██╔██╗ ██║██║   ██║██║ █╗ ██║██╔██╗ ██║    ███████╗██║     ███████║██╔██╗ ██║
██║   ██║██║╚██╗██║██╔═██╗ ██║╚██╗██║██║   ██║██║███╗██║██║╚██╗██║    ╚════██║██║     ██╔══██║██║╚██╗██║
╚██████╔╝██║ ╚████║██║  ██╗██║ ╚████║╚██████╔╝╚███╔███╔╝██║ ╚████║    ███████║╚██████╗██║  ██║██║ ╚████║
 ╚═════╝ ╚═╝  ╚═══╝╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝  ╚══╝╚══╝ ╚═╝  ╚═══╝    ╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝
_________________________________________________________________________________________________________ 
         """)
         print("\n")
         ukn_scan()
         
        
    if n == '22':
         print("\n\n")
         print("  \t\t\t\t\t\t\t\t #####    START SCAN PROCESS    #####")
         print("\n\n")
         print("""
______________________________________________________________________________________________________________ 

███████╗ ██████╗ █████╗ ███╗   ██╗     ██████╗ ███████╗    ████████╗ █████╗ ██████╗  ██████╗ ███████╗████████╗
██╔════╝██╔════╝██╔══██╗████╗  ██║    ██╔═══██╗██╔════╝    ╚══██╔══╝██╔══██╗██╔══██╗██╔════╝ ██╔════╝╚══██╔══╝
███████╗██║     ███████║██╔██╗ ██║    ██║   ██║███████╗       ██║   ███████║██████╔╝██║  ███╗█████╗     ██║   
╚════██║██║     ██╔══██║██║╚██╗██║    ██║   ██║╚════██║       ██║   ██╔══██║██╔══██╗██║   ██║██╔══╝     ██║   
███████║╚██████╗██║  ██║██║ ╚████║    ╚██████╔╝███████║       ██║   ██║  ██║██║  ██║╚██████╔╝███████╗   ██║   
╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝     ╚═════╝ ╚══════╝       ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝ ╚══════╝   ╚═╝                                                                                                                  
______________________________________________________________________________________________________________
         """)
         print("\n")
         OS_scan()
    if n == '23':
         print("\n\n")
         print("  \t\t\t\t\t\t\t\t #####    START SCAN PROCESS    #####")
         print("\n\n")
         print("""
_________________________________________________________________________     

███████╗ █████╗ ███████╗████████╗    ███████╗ ██████╗ █████╗ ███╗   ██╗
██╔════╝██╔══██╗██╔════╝╚══██╔══╝    ██╔════╝██╔════╝██╔══██╗████╗  ██║
█████╗  ███████║███████╗   ██║       ███████╗██║     ███████║██╔██╗ ██║
██╔══╝  ██╔══██║╚════██║   ██║       ╚════██║██║     ██╔══██║██║╚██╗██║
██║     ██║  ██║███████║   ██║       ███████║╚██████╗██║  ██║██║ ╚████║
╚═╝     ╚═╝  ╚═╝╚══════╝   ╚═╝       ╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝  
_________________________________________________________________________   
         """)
         print("\n") 
         FAST_scan()
    if n == '24':
         print("\n\n")
         print("  \t\t\t\t\t\t\t\t #####    START SCAN PROCESS    #####")
         print("\n\n")
         print("""
_________________________________________________________________________________________________________________________________________________________________________________________     

███████╗ ██████╗ █████╗ ███╗   ██╗    ██╗   ██╗███████╗██████╗ ███████╗██╗ ██████╗ ███╗   ██╗     ██████╗ ███████╗    ██████╗ ██████╗  ██████╗ ████████╗ ██████╗  ██████╗ ██████╗ ██╗     
██╔════╝██╔════╝██╔══██╗████╗  ██║    ██║   ██║██╔════╝██╔══██╗██╔════╝██║██╔═══██╗████╗  ██║    ██╔═══██╗██╔════╝    ██╔══██╗██╔══██╗██╔═══██╗╚══██╔══╝██╔═══██╗██╔════╝██╔═══██╗██║     
███████╗██║     ███████║██╔██╗ ██║    ██║   ██║█████╗  ██████╔╝███████╗██║██║   ██║██╔██╗ ██║    ██║   ██║█████╗      ██████╔╝██████╔╝██║   ██║   ██║   ██║   ██║██║     ██║   ██║██║     
╚════██║██║     ██╔══██║██║╚██╗██║    ╚██╗ ██╔╝██╔══╝  ██╔══██╗╚════██║██║██║   ██║██║╚██╗██║    ██║   ██║██╔══╝      ██╔═══╝ ██╔══██╗██║   ██║   ██║   ██║   ██║██║     ██║   ██║██║     
███████║╚██████╗██║  ██║██║ ╚████║     ╚████╔╝ ███████╗██║  ██║███████║██║╚██████╔╝██║ ╚████║    ╚██████╔╝██║         ██║     ██║  ██║╚██████╔╝   ██║   ╚██████╔╝╚██████╗╚██████╔╝███████╗
╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝      ╚═══╝  ╚══════╝╚═╝  ╚═╝╚══════╝╚═╝ ╚═════╝ ╚═╝  ╚═══╝     ╚═════╝ ╚═╝         ╚═╝     ╚═╝  ╚═╝ ╚═════╝    ╚═╝    ╚═════╝  ╚═════╝ ╚═════╝ ╚══════╝
                                                                                                                                                                                           
__________________________________________________________________________________________________________________________________________________________________________________________  
         """)
         print("\n")
         vr_scan()
         print("  \t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    
    if n == '3':
         print("\n\n")
         print("  \t\t\t\t\t\t\t\t #####    START SCAN PROCESS    #####")
         print("\n\n")
         print("""
_____________________________________________________________________________________________________  

███████╗ ██████╗ █████╗ ███╗   ██╗    ███╗   ███╗ █████╗ ███████╗███████╗ ██████╗ █████╗ ███╗   ██╗        
██╔════╝██╔════╝██╔══██╗████╗  ██║    ████╗ ████║██╔══██╗██╔════╝██╔════╝██╔════╝██╔══██╗████╗  ██║        
███████╗██║     ███████║██╔██╗ ██║    ██╔████╔██║███████║███████╗███████╗██║     ███████║██╔██╗ ██║        
╚════██║██║     ██╔══██║██║╚██╗██║    ██║╚██╔╝██║██╔══██║╚════██║╚════██║██║     ██╔══██║██║╚██╗██║        
███████║╚██████╗██║  ██║██║ ╚████║    ██║ ╚═╝ ██║██║  ██║███████║███████║╚██████╗██║  ██║██║ ╚████║        
╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝    ╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝        
                                                                                                                                                                        
_____________________________________________________________________________________________________
         """)
         print("\n")  
         MSF_scan()
    if n == '4':
         print("\n\n")
         print("\n\n")
         print("""
___________________________________________________________________________________________________________________________________________________________

██████╗ ██████╗ ████████╗    ███████╗██████╗        ██╗       ███████╗███╗   ██╗██╗   ██╗███╗   ███╗███████╗██████╗  █████╗ ████████╗██╗ ██████╗ ███╗   ██╗    
██╔══██╗██╔══██╗╚══██╔══╝    ██╔════╝██╔══██╗       ██║       ██╔════╝████╗  ██║██║   ██║████╗ ████║██╔════╝██╔══██╗██╔══██╗╚══██╔══╝██║██╔═══██╗████╗  ██║    
██████╔╝██████╔╝   ██║       █████╗  ██████╔╝    ████████╗    █████╗  ██╔██╗ ██║██║   ██║██╔████╔██║█████╗  ██████╔╝███████║   ██║   ██║██║   ██║██╔██╗ ██║    
██╔══██╗██╔══██╗   ██║       ██╔══╝  ██╔══██╗    ██╔═██╔═╝    ██╔══╝  ██║╚██╗██║██║   ██║██║╚██╔╝██║██╔══╝  ██╔══██╗██╔══██║   ██║   ██║██║   ██║██║╚██╗██║    
██████╔╝██║  ██║   ██║       ██║     ██║  ██║    ██████║      ███████╗██║ ╚████║╚██████╔╝██║ ╚═╝ ██║███████╗██║  ██║██║  ██║   ██║   ██║╚██████╔╝██║ ╚████║    
╚═════╝ ╚═╝  ╚═╝   ╚═╝       ╚═╝     ╚═╝  ╚═╝    ╚═════╝      ╚══════╝╚═╝  ╚═══╝ ╚═════╝ ╚═╝     ╚═╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝    
                                                                                                                                                                                                                                                                                                                                                                                                                                
___________________________________________________________________________________________________________________________________________________________
         """)
         print("\n")  
         brute_force()	
         print("\n")
         print("\n")
         print(" FIN .....  ")     

def vuln_scan():
    ip = input("\n\n ENTER  @IP OF THE TARGET TO FIND THE VULNERABILITIES\n\n FOR EXAMPLE: 127.0.0.1, 10.99.88.77, ... \n\n  VALEUR OF IP  ======>   : ")
    print("\n\n")
    os.system('nmap -sV -sC ' + ip)
    print("  \n\t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    main()
    
def MSF_scan():
    ip = input("\n\nENTER IP OF THE TARGET TO FIND VULNERABILITIES\n\nFOR EXAMPLE: 127.0.0.1, 10.99.88.77, ...\nIP VALUE ======> : ")
    port1 = input("Enter the first value of the range: ")
    port2 = input("Enter the second value of the range: ")
    print("\n\n")
    print("\n\nSCAN IN PROGRESS")
    print("\n\n")
    os.system('masscan -p ' + port1 + '-' + port2 + ' ' + ip)
    print("  \t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    main()
 
def vr_scan():
    ip = input("\n\n ENTER  @IP OF THE TARGET TO FIND THE VULNERABILITIES\n\n FOR EXAMPLE: 127.0.0.1, 10.99.88.77, ... \n\n  VALEUR OF IP  ======>   : ")
    print("\n\n")
    os.system('nmap -sV -sC ' + ip)
    print("  \n\t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    main()

def ukn_scan():
    ip = input("\n\n ENTER  @IP OF THE TARGET \n\n FOR EXAMPLE: 127.0.0.1, 10.99.88.77, ... \n\n  VALEUR OF IP  ======>   : ")
    print("\n\n")
    os.system(' nmap -sS  --reason -D RND,RND,RND,ME ' + ip)
    print("  \n\t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    main()
    
def OS_scan():
    ip = input("\n\n ENTER  @IP OF THE TARGET \n\n FOR EXAMPLE: 127.0.0.1, 10.99.88.77, ... \n\n  VALEUR OF IP  ======>   : ")
    print("\n\n")
    os.system(' nmap -O  --reason  ' + ip)
    print("  \n\t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    main()
    
def FAST_scan():
    ip = input("\n\n ENTER  @IP OF THE TARGET \n\n FOR EXAMPLE: 127.0.0.1, 10.99.88.77, ... \n\n  VALEUR OF IP  ======>   : ")
    print("\n\n")
    os.system(' nmap -T5 -sS --reason -v ' + ip)
    print("  \n\t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    main()
    
def scan_port():
    while True:
        print("\t\t #  Please enter the IP address you want to scan (e.g., 10.10.10.22, 192.168.99.99, ...)")
        ip_add_entered = input("\n\t==> TARGET IP TO SCAN: ")

        if ip_add_pattern.search(ip_add_entered):
            print(f"\n \t > {ip_add_entered} is a valid IP address\n")
            break

    while True:
        print("\t\t #  Please enter the range of ports you want to scan in the format: <int>-<int> (X-X,  60-120)")
        port_range = input("\n\t====> RANGE OF PORTS (TARGET) TO SCAN: ")
        port_range_valid = port_range_pattern.search(port_range.replace(" ", ""))
        
        if port_range_valid:
            port_min = int(port_range_valid.group(1))
            port_max = int(port_range_valid.group(2))
            break

    nm = nmap.PortScanner()
    for port in range(port_min, port_max + 1):
        try:
            result = nm.scan(ip_add_entered, str(port))
            port_status = result['scan'][ip_add_entered]['tcp'][port]['state']
            print(r"*________________________________________________________________________*")
            print(f"Port ====> {port} ========>  is {port_status}")
        except:
            print(f"Cannot scan port {port}.")
    print("  \n\t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")
    main()
            
def attente_et_execution(seconde_attente):
    # Fait attendre le programme pendant le nombre de secondes spécifié.
    time.sleep(seconde_attente)
    
def brute_force():
    print(" \t  *  for example wordlist : /usr/share/wordlists/wordlist.txt \n ")
    wordlist = input(" \t  ==>  Entrez le chemin de la wordlist: ")
    print(" \n\t  *  for example URL  : https://test.com , http://test2.com \n ")
    url = input(" \t  ==>  Entrez l'URL cible: ")
    headers = {
    # vous pouvez remplacez user-agent par votre navigateur que vous utilisez 
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0'
    }
    if not url.startswith('http://') and not url.startswith('https://'):
        print('Veuillez entrer une URL avec un schéma (http:// ou https://)')
        sys.exit(1)
    try:
        with open(wordlist, 'r') as file:
            lines = file.readlines()
        # tester tous les ligne de la liste 
        print(" \n\t resultat :    ## 200 = succès de la requête  ,  404 =  ressource non trouvée  ,   301 = redirection  ## \n "  )
        for line in lines:
            line = line.strip("\n")
            r = requests.get(url + '/' + line, headers=headers)
            print(url + '/' + line, ":", r.status_code)
    except Exception as e:
        print("Une erreur s'est produite :", str(e))
    print("  \n\t\t\t\t\t\t\t\t #####    FIN OF  PROCESS    #####")    
    main()
if __name__ == "__main__":
    main()  
 # ACHRAF BECHEHLA 
